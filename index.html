<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gün Batımı · Sarılmak ister misin?</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      /* Boyutlar ekrana göre ölçeklenir */
      --sun-size: clamp(140px, 18vw, 220px);
      --card-w: min(680px, 92vw);
      --pad: clamp(14px, 2.5vw, 24px);

      /* Renkler */
      --sun:#FFD166;
      --sea1:#0f3057;
      --sea2:#00587a;
      --sky1:#ff9966;
      --sky2:#ff5e62;
      --sky3:#7b2ff7;
      --glass: rgba(255,255,255,.14);
      --glass-border: rgba(255,255,255,.35);
      --white: #ffffff;
    }

    *{box-sizing:border-box}
    html,body{height:100%; margin:0}
    body{
      font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      color:var(--white);
      overflow:hidden;
      /* iOS çentik güvenlik boşlukları */
      padding: env(safe-area-inset-top, 0) env(safe-area-inset-right, 0) env(safe-area-inset-bottom, 0) env(safe-area-inset-left, 0);
    }

    /* Hareket tercihine saygı */
    @media (prefers-reduced-motion: reduce){
      .sea::before{animation: none !important}
      .star{animation: none !important}
    }

    /* Arka plan sahnesi */
    .scene{position:fixed; inset:0; overflow:hidden; display:flex; flex-direction:column;}
    .sky{
      flex:3; /* gökyüzü daha fazla alan */
      background:linear-gradient(180deg,var(--sky1),var(--sky2) 50%,var(--sky3) 100%);
      display:flex; justify-content:flex-end; align-items:flex-end;
      position:relative; padding-right:8%;
    }
    .sun{
      width:var(--sun-size); height:var(--sun-size);
      background:var(--sun); border-radius:50%;
      margin-bottom: calc(var(--sun-size) / -2.2); /* yarısı denizin altında */
      box-shadow:0 0 clamp(40px, 8vw, 90px) rgba(255,209,102,.7);
      flex:0 0 auto;
    }
    .stars{position:absolute; inset:0; pointer-events:none;}
    .star{position:absolute; width:2px; height:2px; background:white; border-radius:50%; opacity:0.9; animation:twinkle 2s infinite alternate;}
    @keyframes twinkle{from{opacity:0.3; transform:scale(.9)} to{opacity:1; transform:scale(1.1)}}

    .sea{flex:1; background:linear-gradient(to bottom,var(--sea1),var(--sea2)); position:relative;}
    .sea::before{content:""; position:absolute; inset:0; background:repeating-linear-gradient(180deg,rgba(255,255,255,.15) 0 2px,transparent 2px 6px); opacity:.2; animation:wave 6s linear infinite;}
    @keyframes wave{from{background-position-y:0} to{background-position-y:100%}}

    /* İçerik kartı */
    .wrap{position:relative; z-index:10; height:100%; width:100%; display:grid; place-items:center; padding:var(--pad);}    
    .card{width:var(--card-w); background:var(--glass); backdrop-filter: blur(10px); border:1px solid var(--glass-border); border-radius:24px; padding:calc(var(--pad) + 6px) var(--pad); box-shadow:0 20px 60px rgba(0,0,0,.25); text-align:center;}

    h1{margin:8px 0 10px; font-size: clamp(22px, 4.5vw, 40px); line-height:1.1; font-weight:800; text-shadow: 0 2px 16px rgba(0,0,0,.25);}    
    .subtitle{opacity:.95; font-size:clamp(13px, 2.6vw, 16px)}

    .gif-box{margin:18px auto 10px; display:flex; justify-content:center}
    .gif-box img{width:min(300px, 70vw); height:auto; border-radius:16px; border:1px solid var(--glass-border); box-shadow:0 12px 40px rgba(0,0,0,.25)}

    .cta-area{margin-top:18px; min-height:64px; display:flex; justify-content:center; gap:10px; flex-wrap:wrap}

    .btn{--btn-bg: rgba(255,255,255,.2); --btn-border: rgba(255,255,255,.5); background:var(--btn-bg); border:1px solid var(--btn-border); color:#fff; padding:12px 18px; border-radius:999px; font-weight:600; font-size:clamp(14px, 1.2vw, 16px); backdrop-filter: blur(8px); box-shadow:0 10px 24px rgba(0,0,0,.18); cursor:pointer; transition:transform .15s ease, box-shadow .2s ease}
    .btn:hover{transform:translateY(-2px); box-shadow:0 14px 32px rgba(0,0,0,.24)}

    #confetti-canvas{position:fixed; inset:0; pointer-events:none; z-index:20; width:100vw; height:100vh}

    /* Küçük ekranlar için ince ayar */
    @media (max-width: 480px){
      .gif-box img{width:min(240px, 82vw)}
      .card{padding:calc(var(--pad) + 2px) var(--pad)}
      .btn{padding:12px 16px}
      .sky{padding-right:6%}
    }
    @media (max-width: 360px){
      .cta-area{flex-direction:column}
      .btn{width:100%}
    }
  </style>
</head>
<body>
  <div class="scene" aria-hidden="true">
    <div class="sky">
      <div class="sun"></div>
      <div class="stars" id="stars"></div>
    </div>
    <div class="sea"></div>
  </div>

  <div class="wrap" role="main">
    <div class="card" aria-live="polite">
      <div class="gif-box">
        <!-- Sarılmak isteyen hareketli kedi GIF -->
        <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNjU4eGFya3N1Y3ZtbTh2bzdlcDFsaDhyajJvZzJoamdlbW9lcXY4cCZlcD12MV9naWZzX3NlYXJjaCZjdD1n/MDJ9IbxxvDUQM/giphy.gif" alt="Sarılmak isteyen kedi" />
      </div>
      <h1>Sana sarılabilir miyim?</h1>
      
      <div class="cta-area" id="ctaArea">
        <button id="yesBtn" class="btn btn-yes" aria-label="Evet">Evet</button>
        <button id="noBtn" class="btn btn-no" aria-label="Hayır">Hayır</button>
      </div>
    </div>
  </div>

  <canvas id="confetti-canvas"></canvas>

  <script>
    // === Yıldızları ekran boyutuna göre üret ===
    const starsContainer = document.getElementById('stars');
    function renderStars(){
      starsContainer.innerHTML = '';
      const area = window.innerWidth * window.innerHeight;
      const count = Math.max(30, Math.min(120, Math.floor(area / 25000))); // 30–120 arası
      for(let i=0;i<count;i++){
        const s=document.createElement('div');
        s.className='star';
        s.style.top=Math.random()*100+'%';
        s.style.left=Math.random()*100+'%';
        const size = (Math.random()*2+1);
        s.style.width=s.style.height=size+'px';
        s.style.animationDuration = (1.6 + Math.random()*1.2) + 's';
        starsContainer.appendChild(s);
      }
    }
    renderStars();
    window.addEventListener('resize', renderStars);

    // === "Hayır" butonunu kaçır ===
    const noBtn = document.getElementById('noBtn');
    function moveNo(){
      const rect = noBtn.getBoundingClientRect();
      const margin = 20; // Daha büyük güvenlik payı
      const cardRect = document.querySelector('.card').getBoundingClientRect();
      const gifRect = document.querySelector('.gif-box img').getBoundingClientRect();
      
      // Gif'in konumunu da hesaba kat
      const safeArea = {
        left: Math.max(margin, cardRect.left + margin),
        right: Math.min(window.innerWidth - rect.width - margin, cardRect.right - rect.width - margin),
        top: Math.max(margin, cardRect.top + margin),
        bottom: Math.min(window.innerHeight - rect.height - margin, cardRect.bottom - rect.height - margin)
      };
      
      let x, y;
      let attempts = 0;
      const maxAttempts = 50;
      
      // Gif ile çakışmayan bir konum bul
      do {
        x = Math.floor(Math.random() * (safeArea.right - safeArea.left)) + safeArea.left;
        y = Math.floor(Math.random() * (safeArea.bottom - safeArea.top)) + safeArea.top;
        attempts++;
        
        // Gif ile çakışma kontrolü
        const buttonRect = {
          left: x,
          right: x + rect.width,
          top: y,
          bottom: y + rect.height
        };
        
        const overlap = !(buttonRect.left > gifRect.right || 
                         buttonRect.right < gifRect.left || 
                         buttonRect.top > gifRect.bottom || 
                         buttonRect.bottom < gifRect.top);
        
        if (!overlap) break;
      } while (attempts < maxAttempts);
      
      noBtn.style.position='fixed';
      noBtn.style.left = x + 'px';
      noBtn.style.top  = y + 'px';
      noBtn.style.zIndex = '1000';
      
      // Butonun görünür olduğundan emin ol
      noBtn.style.opacity = '1';
      noBtn.style.visibility = 'visible';
    }
    
    // Sadece tıklandığında yer değiştir
    noBtn.addEventListener('click', (e)=>{ 
      e.preventDefault(); 
      moveNo(); 
    });
    noBtn.addEventListener('touchstart', (e)=>{
      e.preventDefault();
      moveNo(); 
    }, {passive:false});

    // === Konfeti (yüksek DPI ve mobil için optimize) ===
    const yesBtn = document.getElementById('yesBtn');
    const canvas = document.getElementById('confetti-canvas');
    const ctx = canvas.getContext('2d');

    function resizeCanvas(){
      const dpr = Math.min(window.devicePixelRatio || 1, 2);
      canvas.width  = Math.floor(window.innerWidth  * dpr);
      canvas.height = Math.floor(window.innerHeight * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    function isMobile(){
      return window.matchMedia('(max-width: 600px)').matches;
    }

    function createConfettiBurst(){
      const count = isMobile() ? 130 : 220;
      const parts = [];
      for(let i=0;i<count;i++){
        const angle = Math.random()*Math.PI*2;
        const speed = 5 + Math.random()*7;
        parts.push({
          x: canvas.width/(2*(window.devicePixelRatio||1)),
          y: canvas.height/(2*(window.devicePixelRatio||1)),
          vx: Math.cos(angle)*speed,
          vy: Math.sin(angle)*speed - 3,
          g: 0.18 + Math.random()*0.12,
          drag: 0.002 + Math.random()*0.004,
          size: 5 + Math.random()*6,
          rot: Math.random()*Math.PI,
          vr: (Math.random()-0.5)*0.28,
          color: `hsl(${Math.random()*360}, 90%, 55%)`,
          shape: Math.random() < 0.6 ? 'rect' : 'circle',
        });
      }
      return parts;
    }

    function animateConfetti(parts, ms=2600){
      const start = performance.now();
      function frame(t){
        const elapsed = t - start;
        ctx.clearRect(0,0,canvas.width,canvas.height);
        for(const p of parts){
          p.vx *= (1 - p.drag);
          p.vy += p.g;
          p.x  += p.vx;
          p.y  += p.vy;
          p.rot+= p.vr;
          ctx.save();
          ctx.translate(p.x, p.y);
          ctx.rotate(p.rot);
          ctx.fillStyle = p.color;
          if(p.shape==='rect') ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size*0.6);
          else { ctx.beginPath(); ctx.arc(0,0,p.size/2,0,Math.PI*2); ctx.fill(); }
          ctx.restore();
        }
        if(elapsed < ms) requestAnimationFrame(frame);
      }
      requestAnimationFrame(frame);
    }

    yesBtn.addEventListener('click', (e)=>{
      e.preventDefault();
      animateConfetti(createConfettiBurst());
      
      // Evet butonuna tıklandığında mesajı değiştir
      const title = document.querySelector('h1');
      //title.textContent = '🤍';
      title.style.color = '#FFD166';
      
      // Kedi GIF'ini images klasöründeki görsel ile değiştir
      const gifBox = document.querySelector('.gif-box img');
      gifBox.src = "./images/m.png"; // Bu satırı değiştirin
      gifBox.alt = "Yeni görsel açıklaması";
      
      // Butonları gizle
      document.getElementById('ctaArea').style.display = 'none';
    });
  </script>
</body>
</html>